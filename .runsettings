<?xml version="1.0" encoding="utf-8"?>
<RunSettings>
  <!-- Code Coverage Configuration -->
  <DataCollectionRunSettings>
    <DataCollectors>
      <DataCollector friendlyName="XPlat code coverage">
        <Configuration>
          <Format>json,cobertura,opencover</Format>
          <Exclude>[*.Tests]*,[*.E2ETests]*,[*.IntegrationTests]*,[*.UnitTests]*</Exclude>
          <ExcludeByAttribute>Obsolete,GeneratedCodeAttribute,CompilerGeneratedAttribute</ExcludeByAttribute>
          <ExcludeByFile>**/Migrations/**,**/wwwroot/**,**/*.Designer.cs,**/*.cshtml.cs</ExcludeByFile>
          <IncludeDirectory>../src</IncludeDirectory>
        </Configuration>
      </DataCollector>
    </DataCollectors>
  </DataCollectionRunSettings>

  <!-- Test Configuration -->
  <RunConfiguration>
    <!-- Parallel execution settings -->
    <MaxCpuCount>0</MaxCpuCount> <!-- 0 = use all available cores -->
    <ResultsDirectory>.\TestResults</ResultsDirectory>
    <TargetFramework>net9.0</TargetFramework>
    
    <!-- Test timeout: 5 minutes per test -->
    <TestSessionTimeout>300000</TestSessionTimeout>
  </RunConfiguration>

  <!-- xUnit Configuration -->
  <xUnit>
    <!-- Run tests in parallel -->
    <ParallelizeTestCollections>true</ParallelizeTestCollections>
    <MaxParallelThreads>-1</MaxParallelThreads> <!-- -1 = number of logical processors -->
  </xUnit>

  <!-- NUnit Configuration for E2E tests -->
  <NUnit>
    <!-- Number of workers for parallel execution -->
    <NumberOfTestWorkers>-1</NumberOfTestWorkers> <!-- -1 = auto -->
    <DefaultTimeout>60000</DefaultTimeout> <!-- 60 seconds default timeout -->
  </NUnit>

  <!-- Logging Configuration -->
  <LoggerRunSettings>
    <Loggers>
      <Logger friendlyName="console" enabled="True">
        <Configuration>
          <Verbosity>normal</Verbosity>
        </Configuration>
      </Logger>
      <Logger friendlyName="trx" enabled="True">
        <Configuration>
          <LogFileName>test-results.trx</LogFileName>
        </Configuration>
      </Logger>
    </Loggers>
  </LoggerRunSettings>
</RunSettings>
